# ======================= General ========================
# Use Ctrl-Space as command button
unbind-key C-b
set-option -g prefix F9
#bind-key F9 send-prefix

# Start windows and panes at 1, not 0
set -g base-index 1
setw -g pane-base-index 1

# Terminal
set -ga terminal-overrides ",*256col*:Tc"

# Allow the arrow key to be used immediately after changing windows
set-option -g repeat-time 0
set -sg escape-time 0

# Modes
setw -g mode-keys vi
setw -g mouse on

# Enable native Mac OS X copy/paste
set-option -g default-command "/bin/bash -c 'which reattach-to-user-namespace >/dev/null && exec reattach-to-user-namespace $SHELL -l || exec $SHELL -l'"

# copy mode using 'ยง'
bind-key -n ยง copy-mode
bind P paste-buffer
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi y send-keys -X copy-selection
bind-key -T copy-mode-vi r send-keys -X rectangle-toggle

# ===================== Keybindings ======================
# General
bind-key R source-file ~/.tmux.conf \; display-message "tmux.conf reloaded"
bind-key : command-prompt
bind-key r refresh-client
bind-key s choose-session
bind-key w choose-tree

# Panes and windows
bind-key a last-pane
bind-key q display-panes
bind-key c new-window
bind-key -n M-L next-window
bind-key -n M-H previous-window
bind-key F10 last-window

# Splits
bind-key v split-window -h -c "#{pane_current_path}"
bind-key h split-window -v -c "#{pane_current_path}"

# switch windows alt+number
bind-key -n M-1 select-window -t 1
bind-key -n M-2 select-window -t 2
bind-key -n M-3 select-window -t 3
bind-key -n M-4 select-window -t 4
bind-key -n M-5 select-window -t 5
bind-key -n M-6 select-window -t 6
bind-key -n M-7 select-window -t 7
bind-key -n M-8 select-window -t 8

# Sizes
set-window-option -g other-pane-height 25
set-window-option -g other-pane-width 80
set-window-option -g display-panes-time 1500

# Resize
bind-key -n C-Up resize-pane -U 5
bind-key -n C-Down resize-pane -D 5
bind-key -n C-Left resize-pane -L 5
bind-key -n C-Right resize-pane -R 5


# ======================= Panes ==========================
# Set inactive/active window styles
#set -g window-style 'fg=#dedede,bg=default'
#set -g window-active-style 'fg=#dedede,bg=default'

# Set the pane border colors 
set -g pane-border-style 'fg=colour239,bg=default' 
set -g pane-active-border-style 'fg=colour111,bg=default'

# Move pane to another window
bind-key M choose-tree -Ns "join-pane -t '%%'"


# ===================== Status bar =======================
set-option -g status on

# Gruvbox colors
# bg0: 235
# bg1: 237
# bg2: 239
# bg3: 241
# bg4: 243
# dred: 124
# red: 167
# dred: 124
# dgreen: 106
# green: 142
# dyellow: 172
# yellow: 214
# dblue: 66
# blue: 109
# dpurple: 162
# purple: 175
# daqua: 72
# aqua: 108
# dorange: 166
# orange: 208
# dgray: 245
# gray: 246

BOX_YELLOW='#[fg=colour237,bg=colour142,bold]'
BOX_BLUE='#[fg=colour237,bg=colour66,bold]'
BOX_GREEN='#[fg=colour237,bg=colour106]'
FADED_FG='#[fg=colour241]'
LFG='#[fg=colour222]'
FG='#[fg=colour244]'
STATUS='#[fg=colour172]'
HIGHLIGHT='#[bg=default,fg=colour142]'
SEPARATOR='#[fg=colour239]|'
GIT='#[fg=colour106,bold]'
TEXT_HIGH='#[bg=default,fg=colour66]'
TEXT_FADED='#[bg=default,fg=colour243]'
TEXT_BLUE='#[bg=default,fg=colour66,bold]'
BOX_3='#[bg=colour239,fg=colour247]'
BOX_2='#[bg=colour237,fg=colour243,nobold]'
BOX_1='#[bg=colour243,fg=colour235,bold]'
BOX_0='#[bg=colour237]'

set -g visual-activity off
set -g status 'on'
set -g status-position bottom
set -g status-bg 'default'
set -g status-justify 'left'
set -g status-left-length '100'
set -g status-right-length '100'

set -g message-style fg='colour235',bg='colour66,bold'
set -g message-command-style fg='colour222',bg='colour238'

setw -g window-status-separator ''
setw -g window-status-style fg='colour245',bg='colour237',none
set -g status-left '#{BOX_YELLOW} #S #{BOX_1} #h #[fg=colour223,bg=colour238,nobold,nounderscore,noitalics]#[fg=colour223,bg=colour235] #[fg=colour223,bg=colour235,nobold,nounderscore,noitalics]'
set -g status-right '#[default]#{TEXT_FADED}#(curl icanhazip.com) #[default]#{SEPARATOR} #{TEXT_FADED}%F #{SEPARATOR} #{TEXT_FADED}w%V #{SEPARATOR} #{TEXT_BLUE}%R #[default]'
setw -g window-status-format '#[default] #{FG}#I#{FADED_FG}:#{FG}#W '
setw -g window-status-current-format '#{HIGHLIGHT} #I#[fg=colour142]:#{HIGHLIGHT}#W#{STATUS}#F '
setw -g window-status-activity-style fg='colour208 bold',bg='colour237'

# ======================= Plugins ========================
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin ' tmux-plugins/tmux-sensible'
set -g @plugin 'kristijanhusak/tmux-simple-git-status'
set -g @plugin 'xamut/tmux-network-bandwidth'
set -g @plugin 'tmux-plugins/tmux-cpu'
set -g @plugin 'laktak/extrakto'
set -g @plugin 'levex/tmux-plugin-volume'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'christoomey/vim-tmux-navigator'
run -b '~/.tmux/plugins/tpm/tpm'

# =================== Plugins Settings ====================
# ====> tmux-cpu
set -g @ram_percentage_format "%2.0f %%"
set -g @cpu_percentage_format "%2.0f %%"

# ====> etrakto
set -g @extrakto_split_size "15"
set -g @extrakto_clip_tool "xsel --input --clipboard" # works better for nvim

# =============== Settings after plugins ==================
# Use prefix-l as clear screen and handle vim instance
bind-key l if-shell "$is_vim" "send-keys C-l"  "send-keys C-l"
